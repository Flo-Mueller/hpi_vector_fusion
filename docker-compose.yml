services:
  vector-fusion:
    container_name: ${CONTAINER_NAME}
    build: .
    command: python3 run_painterly_render.py -c vectorfusion.yaml -update="${PARAMS}" -pt "${PROMPT}" -save_step 10 -respath /tmp/workdir -d 8888 --project-name "${WANDB_PROJECT}" --download
    volumes:
      - ./VectorFusion-pytorch:/VectorFusion-pytorch
      - ./assets:/assets
      - ./tmp:/tmp/workdir
    environment:
      WANDB_API_KEY: ${WANDB_API_KEY}
      WANDB_PROJECT: ${WANDB_PROJECT}
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: ["${GPU_ID}"]
              capabilities: [ gpu ]
